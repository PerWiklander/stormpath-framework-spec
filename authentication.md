# Authentication

The underlying SDKs provide Authenticators, which are used for authenticating
a user in various contexts.  A full list can be found here:

https://github.com/stormpath/stormpath-sdk-spec/blob/master/specifications/authenticators.md

Those authenticators have an interface which is *not* HTTP-specific, the
interfaces work with the necessary parameters for achieving authentication.

As such, our framework integrations will be responsible for taking an incoming
HTTP request, gathering the needed authentication parameters (from the body,
from HTTP headers, etc) and delegating to the necessary authenticator.

This work should be encapsulated into re-usable functions that can be exposed
in the public API of the framework.

The default set of functions that we want to provide are:

**User Resolvers**

User resolvers will check for the presense of authentication information, and return user details from Stormpath if available. 

* `getUser` - look for all forms of authentication, and load an account if credentials are present. 

**User Authentication Gatekeepers**

The gatekeepers require that valid authentication information is present, and results in an error if not present. 

If the authentication details are not present, these gatekeepers will ALWAYS render an error, rendered in the best content type as according to the Accept headers and produces configuration. 

If `application/json` is preferred: Render a `401 Unauthorized` with a blank body.

If `text/html` is preferred: Render the unauthorized view. 

The gatekeepers are: 

* `requireUser` - same as `getUser`
* `requireApiAuthentication` - to look for either bearer or basic auth credentials
* `requireBasicAuthentication` - to look for basic only
* `requireBearerAuthentication` - to look for oauth2 bearer tokens only
* `requireCookieAuthentication` - to look for cookie auth only

##Types of Authentication

There are multiple ways that clients can present their authentication credentials to the web framework: 

**Cookie Authentication**

The framework integration should have the ability to accept an OAuth access or refresh token in the cookies as detailed in the [cookie authentication](cookie-authentication.md) document.

**Bearer Authentication**

The framework integration should be able to read an OAuth access token presented in a Bearer Authentication scheme. For reference, access token may be generated by the `password` or `client_credentials` grant types. As an example, this is a HTTP header that looks like this:

```
Authorization: Bearer <OAuth2AccessToken>
```

**Basic Authentication**

The framework integration should be able to read API keys for an Account resource mapped to the application presented in Basic Authentication form. As an example, this is a HTTP header that looks like this:

```
Authorization: Basic <Base64(apiKeyId:apiKeySecret)>
```